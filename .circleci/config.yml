version: 2
jobs:
  build:
    docker:
      - image: circleci/python:3.7.2-stretch
    steps:
      - checkout
      - run: 
          name: Build incremental changes
          command: | 
            CHANGE_CHECKER=./.circleci/changed-since-last-commit.py
            
            if [[ `python3 ${CHANGE_CHECKER} ./project1` == "True" ]]; then
                ./project1/build.sh
            fi

            if [[ `python3 ${CHANGE_CHECKER} ./project2` == "True" ]]; then
                ./project2/build.sh
            fi
